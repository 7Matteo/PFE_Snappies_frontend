<div>
  <button
    id="createtourne"
    *ngIf="userIsAdmin"
    [routerLink]="['/tournee/creation']"
  >
    Créer une nouvelle tournée
  </button>
  <hr />
  <h2>Voici la liste des tournées</h2>

  <!-- Bouton pour créer une nouvelle tournée (visible seulement pour les admins) -->

  <ul>
    <li *ngFor="let tournee of tourneesData">
      <div>
        <!-- Informations sur la tournée -->
       <section> <strong>{{ tournee.nom }}</strong> 
        <section>
          Assigné à {{ tournee.livreur }}
        </section>
      
      </section> 

        <!-- Liste déroulante des livreurs (visible seulement pour les admins) -->
        <select *ngIf="userIsAdmin" [(ngModel)]="selectedLivreurId[tournee.id]">
          <option *ngFor="let livreur of livreurs" [value]="livreur.id_user">
            {{ livreur.username }}
          </option>
        </select>

        <section>
        <!-- Bouton pour assigner la tournée (visible seulement pour les admins) -->
        <button *ngIf="userIsAdmin" (click)="assignerTournee(tournee.id)" class="btn btn-dark">
          Assigner
        </button>

        <!-- Bouton pour afficher les commandes -->
        <button (click)="toggleDetails(tournee)" class="btn btn-success">Afficher les commandes</button>
      </section>

        <!-- Flèche indiquant l'état des détails -->
        <!-- <span
          [ngClass]="{
            'arrow-up': tournee.showDetails,
            'arrow-down': !tournee.showDetails
          }"
        ></span> -->
      </div>
      <div *ngIf="tournee.showDetails">
        <!-- Détails de la tournée -->
        <section
          *ngIf="
            commandesData[tournee.id] && commandesData[tournee.id].length > 0
          "
        >
          <h4>Commandes de la tournée</h4>
          <ul>
            <li *ngFor="let commande of commandesData[tournee.id]">
              <!-- Informations sur le client et son adresse -->
              <strong
                >Client : {{ commande.client }},
                {{ commande.client_adresse }}</strong
              >

              <h5>Details de la commande de {{ commande.client }} :</h5>
              <ul>
                <li *ngFor="let article of commande.articles">
                  <div>
                    <!-- Détails de l'article -->
                    Article: {{ article.nom_article }}
                  </div>
                  <div>
                    Nombre d'articles:
                    <strong>{{ article.nombre_articles }}</strong>
                  </div>
                  <div>
                    Quantité par unité:
                    <strong>{{ article.quantite_unite }}</strong>
                  </div>
                </li>
              </ul>
            </li>
          </ul>
        </section>
      </div>
    </li>
  </ul>
</div>
